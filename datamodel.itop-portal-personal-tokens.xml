<?xml version="1.0" encoding="UTF-8"?>
<itop_design xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="3.1">
  <user_rights>
    <profiles>
      <!-- Extend Portal User profile to allow PersonalToken management -->
      <profile id="2" _delta="must_exist">
        <groups>
          <group id="PersonalToken" _delta="define">
            <actions>
              <action id="action:read">allow</action>
              <action id="action:write">allow</action>
              <action id="action:delete">allow</action>
            </actions>
          </group>
        </groups>
      </profile>
    </profiles>
  </user_rights>
  
  <!-- Add PersonalToken class configuration -->
  <classes>
    <class id="PersonalToken" _delta="must_exist">
      <scopes>
        <scope id="all" _delta="define">
          <oql><![CDATA[SELECT PersonalToken AS pt JOIN User AS u ON pt.user_id = u.id WHERE u.contactid = :current_contact_id]]></oql>
        </scope>
      </scopes>
    </class>
  </classes>
</itop_design>
